<html oncontextmenu="return false" ondragstart="return false" onselectstart="return false"
onbeforecopy="return false">
	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<head>
		<style>
			body{margin:0;}
			a{color:white;text-decoration:none;color:white;font-family:Microsoft Yahei;}			
			#main{overflow:hidden;position:absolute;background:black;opacity:0.8;}
			.dm{position:absolute;white-space:nowrap;-webkit-transition: margin-left 0.5s,margin-top 0.5s;-moz-transition: margin-left 0.5s,margin-top 0.5s;-ms-transition: margin-left 0.5s,margin-top 0.5s;}
		</style>
	</head>
	<body>
		<div id="main">
		</div>
		<script>
			window.onerror = function(){return true;}
			var dm_run = 1;
			var dm_width = document.body.scrollWidth;
			var dm_height = document.body.scrollHeight;
			var dm_main = document.getElementById("main");
			dm_main.setAttribute("style", "width:" + dm_width + "px;height:" + dm_height + "px;");
			function GetRandomNum(Min, Max) {
				var Range = Max - Min;
				var Rand = Math.random();
				return (Min + Math.round(Rand * Range));
			}
			function add_dm(content, dm_style, dm_position) { //"color:red;background:black;position:absolute"
				if (!dm_style) {
					dm_style = "";
				}
				if (!dm_position) {
					dm_position = 3;
				}
				dm_pos = GetRandomNum(1, dm_position + 1);
				var dm_szx = dm_height / dm_position;
				var dm_position_r0, dm_position_r1;
				dm_position_r0 = dm_szx * (dm_pos - 1);
				dm_position_r1 = dm_szx * (dm_pos);
				setTimeout(
				function() {
					var c = document.createElement("span");
					c.setAttribute("style", dm_style);
					c.className="dm";
					c.onmouseover=function(){dm_run=0;}
					c.onmouseout=function(){dm_run=1;}					
					c.innerHTML = content;
					var s = dm_main.appendChild(c);
					s.style.marginTop = GetRandomNum(0, dm_height);
					s.style.marginLeft = dm_width.toString() + "px";
					/*var dogtag = new Date().getTime();
					eval('counter' + dogtag + '= GetRandomNum(0,1000)');*/
					var myFunction = function() {
						if (dm_run) {
							if (parseInt(s.style.marginLeft) > -(dm_width/2)) {
								s.style.marginLeft = parseInt(s.style.marginLeft) - GetRandomNum(0, dm_width/2);
							} else {
								s.style.marginLeft = dm_width.toString() + "px";
							}
							if (parseInt(s.style.marginTop) > 20) {
								if (parseInt(s.style.marginTop) + 20 > dm_height) {
									s.style.marginTop = "40px";
								} else {
									s.style.marginTop = (parseInt(s.style.marginTop) + (GetRandomNum(0, 50) - 20)).toString() + "px";
								}
							} else {
								if (parseInt(s.style.marginTop) < 20 || parseInt(s.style.marginTop) == 20) {
									s.style.marginTop = (dm_height - 40).toString() + "px";
								}
							}
						}
						/*eval('clearInterval(interval' + dogtag + ')');
						eval('counter' + dogtag + ' = GetRandomNum(0,1000);');
						eval('interval' + dogtag + '= setInterval(myFunction' + dogtag + ', counter' + dogtag + ')');*/
					}
					/*eval('myFunction' + dogtag + '=myFunction');
					eval('interval' + dogtag + '= setInterval(myFunction' + dogtag + ', counter' + dogtag + ')');*/
					setInterval(myFunction,  1000);
				},
				GetRandomNum(0, 10) * 1000);
			}

			function contains(a, obj) {
				/*for (var i = 0; i < a.length; i++) {
					if (a[i] === obj) {
						return true;
					}
				}*/

				return a.indexOf(obj)>-1;
			}

			function getdm(code) {
				var s = "";
				var z = [];
				//var w=[];
				var s0 = code.split("[a");
				for (var i = 0; i < s0.length; i++) {
					var s1 = (s0[i].split("[b"))[0].substr(((s0[i].split("[b"))[0].split("]"))[0].length + 1);
					s += s1;
				}
				var t = s.split("\n");
				var ts = t.length > 10 ? 10 : t.length;
				if(ts < 10) {
					z=t.map(function(item,i){
						return i
					})
				} else {
					while (z.length < ts) {

						var n = GetRandomNum(0, t.length - 1);
						var ns = t[n];
						ns = ns ? ns: "";
						if (!contains(z, n) && (ns.length) && (ns.indexOf("="))) {
							z.push(n);
						}

					}				
				}

				setTimeout(
				function() {
					for (var i = 0; i < z.length; i++) {
						//w.push(getlname((t[z[i]].split("="))[1
						var w = getlname((t[z[i]].split("="))[1]);
						w = w ? w: t[z[i]];
						add_dm("<a href='javascript:void(0);' onclick=" + '"opens(this.innerHTML);"' + ">" + w + "</a>");
						console.log(getlname((t[z[i]].split("="))[1]));
					}
				},
				1000);
				console.log(z.length);
			}
			function opens(key){
				var s=window.parent.isearch(key);
				if(!s){
					window.open(top.location.href + "#Search|" + encodeURIComponent(key),'_top');
					top.location.reload();
				}
			}
			function loaddata(url, type, data, code, timeout, errorcode, timeoutcode, encoding, jsback) {
				var xmlhttp = null;
				if (window.XMLHttpRequest) {
					xmlhttp = new XMLHttpRequest();
				} else{
					if (window.ActiveXObject) {
						xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
					}
				}
				if (xmlhttp != null) {
					xmlhttp.onreadystatechange = function() {
						try{
							if (xmlhttp.readyState == 4) {
							//alert(xmlhttp.status);
								if ((xmlhttp.status>= 200 && xmlhttp.status < 300) || xmlhttp.status==304) {
									code&&code(this.response,jsback);
								} else {
									errorcode&&errorcode(xmlhttp.statusText,jsback);
									//alert('Problem retrieving XML data:' + xmlhttp.statusText);
								}
							}
						}catch(e){}	
					}
					xmlhttp.open(type, url, true);
					timeout&&(xmlhttp.timeout = timeout);
					timeoutcode&&(xmlhttp.ontimeout = function(){timeoutcode&&timeoutcode(this,jsback);});
					encoding&&xmlhttp.overrideMimeType("text/html;charset=" + encoding);
					xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
					xmlhttp.send(data);
				} else {
					errorcode&&errorcode("Your browser does not support XMLHTTP.");
					//alert('Your browser does not support XMLHTTP.');
				}
			}
			function curl(url,rdb) {
				try{
					if(window.parent.cstrdata(rdb)){
						getdm(window.parent.cstrdata(rdb));
						return;
					}
				}catch(e){}
				loaddata(url, "GET", "",function(result){if(result){try{window.parent.cstrdata(rdb,result);}catch(e){}getdm(result);}},"","","","gb2312");
			}
			function getlname(t) {
				try{
					//t=t.replace(/【/,' [').replace(/】/,'] ');
					var t0 = (t.split(" "))[0];
					/*var idReg=/^[0-9][0-9]*$/; // 数字
					 if (!idReg.test(t0)){return t;}*/
					var t1 = t.substr(t0.length + 1).trim();
					if (t1) {
						if (t1.substr(0, 1) == "[") {
							var t2 = (t1.split("]"))[0];
							var t3 = t1.substr(t2.length + 1).trim();
							if (t3) {
								t = t3;
							}
						} else {
							t = t1;
						}
					}
					t=t.trim();
				}catch(e){}	
				return t;
			}
			var dataurl = 'data/'
			for (var rdb = 0; rdb < 4; rdb++) {
				var url = dataurl + "database" + ((rdb) ? (rdb) : ("")) + ".lib";
				curl(url,rdb);
			}
		</script>
	</body>
</html>